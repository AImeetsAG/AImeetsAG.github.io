<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Temporal graphs for recommender systems | Abhinav Chand</title> <meta name="author" content="Abhinav Chand"/> <meta name="description" content="a data science project to use temporal graphs to recommend music"/> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://github.com/AImeetsAG/AImeetsAG.github.io/projects/4_project/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Abhinav&nbsp;</span>Chand</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/notes&talks/">notes&talks</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Temporal graphs for recommender systems</h1> <p class="post-description">a data science project to use temporal graphs to recommend music</p> </header> <article> <h2 id="motivation-and-goal">Motivation and goal</h2> <p>“Nearly 616.2 million people listen to their favorite artists or discover new ones via online streaming platforms”[^statista]. Hence, streaming platforms seek to increase enhance the user experience by offering personalized music recommendations, moreover, users value personalization as a top feature [^spotify]. At the same time, music streaming services are able to track individual preferences meticulously, thus, a growing volume of data on multiple user’s musical preferences is available. In response, we aimed to develop a recommendation model that predicts the genres a user is expected to like.</p> <h2 id="dataset">Dataset</h2> <p>We worked with <em>tgbn-genre</em> dataset, a temporal evolving graph from Temporal Graph Benchmark (TGB) <sup id="fnref:huang23" role="doc-noteref"><a href="#fn:huang23" class="footnote" rel="footnote">1</a></sup>. The grapgh ( <em>tgbn-genre_edgelist</em>) consists of 992 users and 513 music genre represented as nodes and weighted edges that indicates a user listens to a music genre at a given time. The temporal graph evolves over the span of 4 years and 4 months approximately. This dataset was generated by merging the LastFM dataset<sup id="fnref:last_fm" role="doc-noteref"><a href="#fn:last_fm" class="footnote" rel="footnote">2</a></sup> and million songs<sup id="fnref:million" role="doc-noteref"><a href="#fn:million" class="footnote" rel="footnote">3</a></sup> dataset with some preprocessing. The LastFM dataset has data on 992 users listening to songs on the last.fm website along with the timestamps of the songs play. The million songs dataset has data on songs and their respective genre/tags along with the weights assigned to each genre/tag.</p> <p>The dataset <em>tgbn-genre_edgelist</em> posed a challenge since the description given by the creators of the dataset did not match it. Additionally, it has anomalies and multiple duplicates. Hoewever, it was then processed into <em>tgbn-genre_node_labels</em> a dynamical frequency interaction matrix where the interaction of each user and each genre is normalized over the span of a week. We train our models on this second dataset. Nevertheless, we explore the first dataset to comprehend the second one.</p> <p align="center" width="50%"> <img src="presentation/images/user-genre-interaction.png" width="800"/> </p> <p>“The Million Song Dataset”. <em>In Proceedings of the 12th International Society for Music Information Retrieval Conference (ISMIR 2011)</em>, 2011. http://millionsongdataset.com/</p> <h2 id="exploratory-data-analysis">Exploratory Data Analysis</h2> <p>As previously mentioned, the <em>tgbn-genre</em> dataset posed a challenge. In <a href="https://github.com/AImeetsAG/Temporal-Graphs-for-recommenders/blob/main/notebooks/01-tgbn-genre-raw-data-preprocessing.ipynb"><code>raw-data-notebook</code></a> we showcase the duplicates and anomalies on the dataset.</p> <p>Later, we processed the data into <em>tgbn-genre_node_labels</em> (see <a href="https://github.com/AImeetsAG/Temporal-Graphs-for-recommenders/blob/main/notebooks/02-eda-tgbn-genre-dataset.ipynb"><code>eda-data-notebook</code></a> ). This proccess ‘discretize’ our data. We partition the total time range of the dataset into more-or-less 24-hour periods and combine all records for a given user and genre in a given 24-hour period into a single record for that day, by summing the corresponding edge weights. The sum of the edge weights over a 24-hour period represents a user’s genre interactions for that day.</p> <p>Then, for each user-genre pair, the discretized edge weight over each seven-day period are combined into a single number between 0 and 1. The number, called a ‘label_node’, reflects a user’s proclivity towards a certain genre over a given week, relative to all other genres. If a user doesn’t listen to any songs belonging to a certain genre during the week, the weight corresponding to that genre is 0. If a user listens exclusively to songs that are 100% a certain genre during the week, the weight corresponding to that genre is 1. The label_nodes are normalized so that they sum to 1.</p> <p>In the process, we performed a comparison including and non including the duplicate records. After the process we found the distribution of the error is largely centred around 0 as desired.</p> <p>On the other hand, we evaluate some features on our data in the <a href="feature_generation"><code>feature_generation</code></a> directory finding a similarity graph of music genres.</p> <p align="center" width="50%"> <img src="/assets/img/genre-similarity.png" width="500"/> </p> <h2 id="modelling-approach">Modelling Approach</h2> <p><strong>Train-test-split</strong>: We split chronologically into the train, validation and test set with 70\%, 15\% and 15\% of the edges respectively.</p> <p><strong>Models:</strong> We experimented with several time series models. For the baseline model we chose the latest node label, i.e., for each user and genre in the test dataset, we look at the latest weight of that user for that genre in the training set and use that as the prediction. We looked at the time signal of the user genre weights for many users and did not find any seasonality or trend. Moreover, it was not feasible to detect seasonality or trend for all 992 users with a scalable algorithm.</p> <p>Then we tried rolling average and did hyperparameter tuning with the window parameter. Finally we tried exponential smoothing with hyperparameter tuning on the smoothing parameter.</p> <p><strong>Key performance indicator:</strong> We use the normalized discounted cumulative gain with 10 items (NDCG@10)<sup id="fnref:ndcg" role="doc-noteref"><a href="#fn:ndcg" class="footnote" rel="footnote">4</a></sup>. It is the sum of the relevance of the item divided by the log basis two of the rank of the item plus one. So this is a holistic metric that accounts for both the relevance of the item and the rank of the prediction. To get the normalized version of the discounted cumulative gain, the discounted cumulative gain is divided by the maximum possible score.</p> <h2 id="results">Results</h2> <table> <thead> <tr> <th>Model</th> <th>NDCG @10 (Validation) +- 0.0001</th> <th>NDCG @10 (Test) +-0.0001</th> </tr> </thead> <tbody> <tr> <td>Latest node label (Baseline)</td> <td>0.18068</td> <td>0.1575</td> </tr> <tr> <td>Mean node label</td> <td>0.2310</td> <td>0.2034</td> </tr> <tr> <td>Median node label</td> <td>0.2140</td> <td>0.1888</td> </tr> <tr> <td>Rolling average (Window=7)</td> <td>0.2242</td> <td>0.1951</td> </tr> <tr> <td>Rolling average (Window=14)</td> <td>0.2333</td> <td>0.2008</td> </tr> <tr> <td>Rolling average (Window=21)</td> <td>0.2345</td> <td>0.2014</td> </tr> <tr> <td>Exponential Smoothing ($\alpha=0.8$)</td> <td>0.1941</td> <td>0.1662</td> </tr> <tr> <td>Exponential Smoothing ($\alpha=0.4$)</td> <td>0.1827</td> <td>0.1619</td> </tr> </tbody> </table> <h2 id="conclusions-and-future-directions">Conclusions and Future Directions</h2> <p>We want to exploit the graph structure of our data to train graph neural networks and learn the interaction of users and music genres. Also, train classical and deep learning multivariate time series models to analyze the music genre preferences of one user. Ultimately, offer streaming services a recommendation system that can create a great and unique experience for each user.</p> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:huang23" role="doc-endnote"> <p>Huang, S., et al.”Temporal graph benchmark for machine learning on temporal graphs” <em> Advances in Neural Information Processing Systems </em>, 2023. Preprint: <a href="https://doi.org/10.48550/arXiv.2307.01026">arXiv:2307.01026</a>, 2023. <a href="#fnref:huang23" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:last_fm" role="doc-endnote"> <p>Celma O. “Music Recommendation and Discovery in the Long Tail”. <em>Springer</em>. Ch. 3. 2010. http://ocelma.net/MusicRecommendationDataset/lastfm-1K.html. <a href="#fnref:last_fm" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:million" role="doc-endnote"> <p>Bertin-Mahieux T. , Ellis D., Whitman B., and Lamere P. . <a href="#fnref:million" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:ndcg" role="doc-endnote"> <p>Evidently AI Team. “Normalized Discounted Cumulative Gain (NDCG) explained” https://www.evidentlyai.com/ranking-metrics/ndcg-metric#:~:text=Normalized%20Discounted%20Cumulative%20Gain%20(NDCG)%20is%20a%20ranking%20quality%20metric,the%20top%20of%20the%20list. Accessed Jun 1, 2024. <a href="#fnref:ndcg" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> </ol> </div> </article></div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> &copy; Copyright 2024 Abhinav Chand. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>